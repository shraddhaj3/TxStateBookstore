<%@ page import="txstatebookstore.Book" %>
<!DOCTYPE html>
<html>
	<head>
		<meta name="layout" content="main">
		<title>My Shopping Cart</title>
	</head>
	<body>
		<div style="margin: 20px;">	
			<h1>My Shopping Cart</h1>
			<a href="#list-book" class="skip" tabindex="-1"><g:message code="default.link.skip.label" default="Skip to content&hellip;"/></a>
			<g:if test="${session.myCart == null || session.myCart.isEmpty() }">
				<h3>Your shopping cart is empty!</h3>
			</g:if>
			<g:else>
				<h1>Items in your cart</h1>
				<table>
					<thead>
						<tr>
							<td>Book</td>
							<td>Price</td>
							<td>Quantity</td>
							<td>Actions</td>
						</tr>
					</thead>
					<tbody>
						<g:each in="${cart}" var="item">
							<tr>
								<td><span><img width="100px" src="${createLink(controller:'Book', action:'showPayload', id: item.id)}"/></span>
								<br/>
								<g:link controller="Book" action="show" id="${item.id}"></g:link></td>
								<td>
									<b>${book.title} </b><g:if test="${book.authors} != null"> by </g:if>${book.authors} 
									<br/>
									Published by: ${book.publisher } 
									<br/>
									Published in year: ${book.yearOfPublication}
									<br/>
									ISBN: ${book.isbn }
									<br/>
									<b>Price: $ ${book.price }</b>
									
								</td>
								<td>
									<g:if test="${session.role == 'admin' }">
										<g:link controller="Book" action="edit" id="${book.id }">Edit Book</g:link>  
									</g:if>
									<g:else>
										<g:link controller="Book" action="addToCart" id="${book.id }">Add to Cart</g:link>
									</g:else>
								</td>
							</tr>
						</g:each>
					</tbody>
				</table>
				
				<g:each in="${cart }" var="item">
					${item.value}
				</g:each>
			</g:else>
		</div>
	</body>
</html>